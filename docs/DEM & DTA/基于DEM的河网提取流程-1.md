# 基于DEM的水系/河网提取方法、流程学习笔记
[toc]
## 1. 水系提取
>汤国安等，数字高程模型及地学分析的原理和方法，p243

### 1.1 概述
1. 集水流域：水流及其他物质流向流域出口的过程中所流经的区域，即流向集水出口的水流所流经的整个地区
2. 集水出口：水流离开集水流域的点，是集水流域边界上的最低点
3. 子流域：较大的集水流域结构中的一部分
4. 分水岭：两个集水流域的边界
5. 水流网络：流水到达集水出口所流经的网络结构，可视为一树状结构，根节点为集水出口，两支流的交点成为水流网络节点<br/>

![流域][1]

### 2. 基于地表径流漫流模型的水系提取
>地表径流漫流模型：模拟地表径流在地表的的流动来产生水系。基本原理是根据DEM栅格单元和八个相邻单元之间的最大坡度来确定水流方向，即D8算法，然后计算每个单元格的上游汇水面积，接着确定一个汇水面积阈值，不低于该阈值的单元格标记为水系的组成部分。

#### 2.1 四个基本问题：
1. 洼地处理
2. 平地处理
3. 水流方向及水流累积量确定
4. 水道真实位置确定

#### 2.2 洼地处理
洼地是局部的最低点，由于**水往低处流**，故无法确定该点的水流方向，因此需要在提取水系之前对其进行无洼地化处理。
常用方法有两种：
1. 平滑处理：对原始数据平滑处理，只能处理较浅和小范围的洼地，改变了原始数据。
2. 填平处理：将洼地内部高程增加至洼地出水口的高程。

李志林（1999）、Martez和Garbrecht等提出了多种填平处理方法。李志林（1999）将洼地分为*单格网洼地*、*独立洼地（只有一个谷底点）*、*复合洼地（有多个谷底点，且各洼地区域相邻接）*。

#### 2.3 平地处理
包括原始数据中的平地和填洼处理之后产生的平地。平地区域对水流方向确定有重要影响，可能生成平行状河流（平行河网）。
Martez和Garbrecht（1992）用高程增量叠加算法设定平坦格网内水流方向。即对平地范围内的单元格增加一微小增量，每个单元格的增量都不一样。

#### 2.4 流向及水流累积量确定
水流方向指水流离开单元格时的指向。主要有 *单流向算法（SFD）* 和 *多流向算法（MFD）* 等类。单流向算法将某格网上产生的水流都流向一个最低的相邻单元格；多流向算法是将径流按一定的比例流向若干相对较低的相邻单元格。多流向算法分析评价可参考 *秦承志等（2006）* 的 *《基于栅格DEM的多流向算法述评》* 一文。

|分类|主要算法|
| ------------- | -------------- | 
| 单流向算法SFD | 最大坡降算法D8(Deterministic eight-node)(O’Callaghan and Mark, 1984)<br/>随机四方向算法Rho4(random four-node)（Fairefield et al.,1991） <br/>随机八方向算法Rho8（Fairefield et al.,1991）<br/>流向驱动法(aspect driven)(Lea,1992)|
| 多流向算法MFD | 基于坡度的MFD (Quinn et al. 1991) <br/>基于坡度指数的MFD（Freeman ，1991);<br/>流管法DEMON（Coast-Cabral et al.,1994）<br/>无穷向算法Dinf（Tarboton，1997）<br/>形态算法（Pilesjo et al.,1998）<br/>水流分配策略随下坡坡度变化的多流向算法MFD-md(Qin et al., 2007)| 
| 其他          | 混合算法<br/>多级骨架算法               | 
 其中，MFD-md (Qin et al., 2007)以局域最大下坡的线性函数 来计算随局域地形条件自适应的水流分配指数。
 
 

## 2. ArcHydro Tools 及多源 DEM 提取河网
### 2.1 缺乏辅助信息下的河网提取划分
>曾红伟等，ArcHydro Tools 及多源 DEM 提取河网与精度分析——以洮儿河流域为例

1. 填洼
2. 流向 Flow Direction
3. 汇流累积（矩阵）生成 Flow Accumulation - 汇流累积栅格图
4. 河流栅格图生成 Stream Definition 给定最小汇水面积阈值，并采用 Stream Segmentation 方法建立栅格河段上下游拓扑关系
5. 流域边界生成 Catchment Grid Delineation，使用 Catchment Polygon Processing 方法, 生成的流域整体边界 Catchment
6. 河网矢量化 Drainage Line Processing

### 2.2 辅助信息下河网提取
>流域内真实河流

增加步骤：
 1. 河网校正 DEM Reconditioning
 2. 流域边界校正 Build Walls
 3. 划分流域与子流域: 以水文站点为流域出口, 划分各流域和子流域（Watershed & Subwatershed）。


----------

参考文献：
>宋晓猛等，基于DEM的数字流域特征提取研究进展，2013
>刘学军等，基于DEM的河网提取算法的比较，2006
>汤国安等，数字高程模型及地学分析的原理和方法，2005
>秦承志等，水流分配策略随下坡坡度变化的多流向算法，2010
>秦承志等，基于栅格DEM的多流向算法述评，2006
>曾红伟等，ArcHydro Tools 及多源 DEM 提取河网与精度分析——以洮儿河流域为例，

  [1]: ./images/1476893824520.jpg "流域"