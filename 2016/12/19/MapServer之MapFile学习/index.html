<!-- build time:Mon Jul 02 2018 09:30:37 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-Hans"><head><!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="侯志伟 - houzhiwei"><meta name="description" content="MapFile 是 MapServer 的核心。它定义了各地图对象间的关系，指出MapServer中的数据位置所在，并定义了数据如何显示。Mapfile 用于控制对数据的栅格或矢量输出，其中包含了数据源和渲染样式（颜色、符号、标准等）信息。此文综合网络资料，对mapfile主要内容进行了简要说明，最后引用说明了一个带注释的示例"><meta property="og:type" content="article"><meta property="og:title" content="MapServer之MapFile学习"><meta property="og:url" content="houzw.github.io.git/2016/12/19/MapServer之MapFile学习/index.html"><meta property="og:site_name" content="V make the world smart"><meta property="og:description" content="MapFile 是 MapServer 的核心。它定义了各地图对象间的关系，指出MapServer中的数据位置所在，并定义了数据如何显示。Mapfile 用于控制对数据的栅格或矢量输出，其中包含了数据源和渲染样式（颜色、符号、标准等）信息。此文综合网络资料，对mapfile主要内容进行了简要说明，最后引用说明了一个带注释的示例"><meta property="og:image" content="http://img.blog.csdn.net/20151018225958746"><meta property="og:updated_time" content="2018-06-12T08:09:40.756Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="MapServer之MapFile学习"><meta name="twitter:description" content="MapFile 是 MapServer 的核心。它定义了各地图对象间的关系，指出MapServer中的数据位置所在，并定义了数据如何显示。Mapfile 用于控制对数据的栅格或矢量输出，其中包含了数据源和渲染样式（颜色、符号、标准等）信息。此文综合网络资料，对mapfile主要内容进行了简要说明，最后引用说明了一个带注释的示例"><meta name="twitter:image" content="http://img.blog.csdn.net/20151018225958746"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="alternate" href="/atom.xml" title="V make the world smart" type="application/atom+xml"><link rel="shortcut icon" href="/favicon.ico"><link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet"><link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"><title>MapServer之MapFile学习 | V make the world smart</title><script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script>var yiliaConfig={fancybox:!0,animate:!0,isHome:!1,isPost:!0,isArchive:!1,isTag:!1,isCategory:!1,fancybox_js:"//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",scrollreveal:"//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",search:!0}</script><script>yiliaConfig.jquery_ui=[!0,"//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js","//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"]</script><script>yiliaConfig.rootUrl="/"</script></head></html><body><div id="container"><div class="left-col"><div class="overlay"></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="http://ofcj2lgtd.bkt.clouddn.com/avatar.jpg" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/">侯志伟 - houzhiwei</a></h1></hgroup><p class="header-subtitle">houzhiwei&#39;s blogs</p><form id="search-form"><input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false"> <i class="fa fa-times" onclick="resetSearch()"></i></form><div id="local-search-result"></div><p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p><div id="switch-btn" class="switch-btn"><div class="icon"><div class="icon-ctn"><div class="icon-wrap icon-house" data-idx="0"><div class="birdhouse"></div><div class="birdhouse_holes"></div></div><div class="icon-wrap icon-ribbon hide" data-idx="1"><div class="ribbon"></div></div><div class="icon-wrap icon-link hide" data-idx="2"><div class="loopback_l"></div><div class="loopback_r"></div></div><div class="icon-wrap icon-me hide" data-idx="3"><div class="user"></div><div class="shoulder"></div></div></div></div><div class="tips-box hide"><div class="tips-arrow"></div><ul class="tips-inner"><li>菜单</li><li>标签</li><li>友情链接</li><li>关于我</li></ul></div></div><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">关于我</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" href="mailto:&#104;&#111;&#117;&#122;&#119;&#64;&#108;&#114;&#101;&#105;&#115;&#46;&#97;&#99;&#46;&#99;&#110;" title="Email"></a> <a class="fa 新浪微博" href="http://weibo.com/singland" title="新浪微博"></a> <a class="fa GitHub" href="https://github.com/houzw" title="GitHub"></a> <a class="fa RSS" href="/atom.xml" title="RSS"></a> <a class="fa 博客园" href="http://www.cnblogs.com/yes-V-can/" title="博客园"></a></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id="js-tagcloud"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/3S/">3S</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArcGIS/">ArcGIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CXF/">CXF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CentOS/">CentOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CentOS7/">CentOS7</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto-js/">Crypto-js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DEM/">DEM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ESDL/">ESDL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GIS/">GIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GNSS/">GNSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GRASS-GIS/">GRASS-GIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Header-First/">Header First</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MapFile/">MapFile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MapServer/">MapServer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/">Maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ontology/">Ontology</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenLayers3/">OpenLayers3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RS/">RS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOAP/">SOAP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shiro学习/">Shiro学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-MVC/">Spring MVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VNC/">VNC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WPS/">WPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebService/">WebService</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cxf/">cxf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cygwin/">cygwin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gdal/">gdal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gis/">gis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/schema/">schema</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/taudem5/">taudem5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分类/">分类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/加解密/">加解密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/地理信息系统/">地理信息系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/地理空间/">地理空间</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基本命令/">基本命令</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/安全/">安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发/">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源/">开源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/插件/">插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/教程/">教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/本体/">本体</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/河网/">河网</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/目录结构/">目录结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/空间关系/">空间关系</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/空间数据/">空间数据</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编辑器/">编辑器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/规范/">规范</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/配置/">配置</a></li></ul></div></section><section class="switch-part switch-part3"><div id="js-friends"><a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a> <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a> <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a></div></section><section class="switch-part switch-part4"><div id="js-aboutme">热爱旅行但很宅，热爱技术但很菜，身为GISer一直Coder，想要改变世界，先得改变自己</div></section></div></div></header></div></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">侯志伟 - houzhiwei</a></h1></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="http://ofcj2lgtd.bkt.clouddn.com/avatar.jpg" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/" title="回到主页">侯志伟 - houzhiwei</a></h1></hgroup><p class="header-subtitle">houzhiwei&#39;s blogs</p><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">关于我</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" target="_blank" href="mailto:&#104;&#111;&#117;&#122;&#119;&#64;&#108;&#114;&#101;&#105;&#115;&#46;&#97;&#99;&#46;&#99;&#110;" title="Email"></a> <a class="fa 新浪微博" target="_blank" href="http://weibo.com/singland" title="新浪微博"></a> <a class="fa GitHub" target="_blank" href="https://github.com/houzw" title="GitHub"></a> <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a> <a class="fa 博客园" target="_blank" href="http://www.cnblogs.com/yes-V-can/" title="博客园"></a></ul></nav></header></div><link class="menu-list" tags="标签" friends="友情链接" about="关于我"></nav><div class="body-wrap"><article id="post-MapServer之MapFile学习" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2016/12/19/MapServer之MapFile学习/" class="article-date"><time datetime="2016-12-19T06:54:43.000Z" itemprop="datePublished">2016-12-19</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 class="article-title" itemprop="name">MapServer之MapFile学习</h1></header><div class="article-info article-info-post"><div class="article-category tagcloud"><a class="article-category-link" href="/categories/GIS-GIS开发/">GIS-GIS开发</a></div><div class="article-tag tagcloud"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GIS/">GIS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MapFile/">MapFile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MapServer/">MapServer</a></li></ul></div><div class="clearfix"></div></div><div class="article-entry" itemprop="articleBody"><h1 id="MapServer之MapFile学习"><a href="#MapServer之MapFile学习" class="headerlink" title="MapServer之MapFile学习"></a>MapServer之MapFile学习</h1><p>##参考教程</p><p>教程 <a href="http://mapserver.org/tutorial/index.html" target="_blank" rel="external">http://mapserver.org/tutorial/index.html</a></p><p>教程资料，含数据 <a href="http://download.osgeo.org/mapserver/docs/mapserver-tutorial.zip" target="_blank" rel="external">http://download.osgeo.org/mapserver/docs/mapserver-tutorial.zip</a></p><blockquote><p>MapFile Editors</p><p><strong><a href="https://github.com/mapserver/mapserver/wiki/MapFile-Editors" target="_blank" rel="external">https://github.com/mapserver/mapserver/wiki/MapFile-Editors</a></strong></p></blockquote><p>##MapServer访问地址解析</p><p>如 <code>http://localhost/cgi-bin/mapserv?map=/ms4w/apps/tutorial/htdocs/example1-1.map&amp;layer=states&amp;mode=map</code> ，分为两个部分：</p><ul><li><p><code>http://localhost/cgi-bin/mapserv?</code>（windows下位 mapserv.exe）</p><p>调用 MapServer CGI 程序。直接访问出现信息</p><p><code>No query information to decode. QUERY_STRING is set, but empty.</code></p></li><li><p>查询字符串，包含CGI参数，以<code>&amp;</code>隔开</p><ul><li>参数 map，值<code>/ms4w/apps/tutorial/htdocs/example1-1.map</code>，指定 MapServer CGI程序需要处理的 mapfile 文件</li><li><em><code>layer=states</code></em>，指定 mapserv 程序启用 <code>states</code>图层</li><li><em><code>mode=map</code></em> ，指定 mapserv 对 mapfile 输出的处理方式。<ul><li>map 方式：直接发送图片到浏览器，而不在服务器中创建临时的图片</li><li>browser方式：在服务器中创建一个图片的临时目录</li></ul></li></ul></li></ul><hr><blockquote><p><a href="http://live.osgeo.org/zh/quickstart/mapserver_quickstart.html" target="_blank" rel="external">http://live.osgeo.org/zh/quickstart/mapserver_quickstart.html</a></p><p><a href="http://blog.csdn.net/qingyafan/article/details/49126705" target="_blank" rel="external">MapServer 之 mapfile 配置文件</a></p><p><a href="https://doc.tiki.org/Maps+Mapfile+Tutorial" target="_blank" rel="external">https://doc.tiki.org/Maps+Mapfile+Tutorial</a></p><p>MapServer官方文档 <a href="http://mapserver.org/mapfile/index.html" target="_blank" rel="external">http://mapserver.org/mapfile/index.html</a></p></blockquote><p>[TOC]</p><h2 id="MapFile简介"><a href="#MapFile简介" class="headerlink" title="MapFile简介"></a>MapFile简介</h2><p><strong>MapFile 是 MapServer 的核心</strong>。它定义了对象间的关系，指出MapServer中的数据位置，并定义了数据如何显示。即 <a href="http://mapserver.org/mapfile/index.html" target="_blank" rel="external">Mapfile</a> 用于控制对数据的栅格或矢量输出，其中包含了数据源和渲染样式（颜色、符号、标准等）信息。</p><p>QGIS中有一个 MapServer Export Plugin，可以在QGIS中配置好数据和样式之后，导出mapfile。</p><p>MapFile中的每个对象以其名称开始，以<strong><em>END</em></strong>结束（<strong>对象必须闭合</strong>）。MapFile中标签<strong>不区分大小写</strong>，但最好是大写。MapFile 中的注释使用 <code>#</code>(hash)。MapFile文件包含一个Map对象，其以“<strong><em>Map</em></strong>”开始，包含一系列的<strong><em>LAYER</em></strong>对象。在有多个 <code>LAYER</code>对象的时候，在前面的 <code>LAYER</code>会先绘制，后面的 <code>LAYER</code>会叠加在先绘制的图层上面。</p><p>——每个MapFile文件都必须以<strong><em>Map</em></strong>开始，以<strong><em>END</em></strong>结束。</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">MAP</div><div class="line"> ...</div><div class="line">   LAYER</div><div class="line">   ...</div><div class="line">   END <span class="comment"># end of layer1</span></div><div class="line">END <span class="comment"># end of map</span></div></pre></td></tr></table></figure><p>每个对象都有很多的配置参数，配置参数<strong>不必闭合</strong>。参数值为字符串时，最好<strong>加双引号</strong>。</p><p>Mapfile 使用 UTF-8 编码保存，后缀为<code>map</code> .</p><p><img src="http://img.blog.csdn.net/20151018225958746" alt="mapfile应用过程示意图"></p><p>mapfile应用过程示意图，出自【MapServer 之 mapfile 配置文件】</p><h2 id="MapFile的头部"><a href="#MapFile的头部" class="headerlink" title="MapFile的头部"></a>MapFile的头部</h2><p>mapfile 的头部（header）定义了一些控制地图在屏幕上显示效果的对象。包括<strong>MAP</strong>本身（最后需要END），决定如何创建网络地图图片的<strong>WEB</strong>对象、参考图或鹰眼图对象<strong>REFERENCE</strong>、比例尺对象<strong>SCALEBAR</strong>、图例对象<strong>LEGEND</strong>及控制地图是否能够查询的对象<strong>QUERYMAP</strong>。</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># Start of map file</span></div><div class="line">MAP</div><div class="line">    NAME <span class="string">"Efate"</span></div><div class="line">    STATUS ON</div><div class="line">    SIZE <span class="number">400</span> <span class="number">400</span></div><div class="line">    EXTENT <span class="number">196900</span> <span class="number">8027100</span> <span class="number">245000</span> <span class="number">8073000</span></div><div class="line">    UNITS METERS</div><div class="line">    SHAPEPATH <span class="string">"/var/www/html/map/"</span></div><div class="line">    IMAGETYPE png24</div><div class="line">    FONTSET <span class="string">"fonts/fontset.txt"</span></div><div class="line">    OUTPUTFORMAT</div><div class="line">        NAME png24</div><div class="line">        DRIVER <span class="string">"GD/PNG"</span></div><div class="line">        MIMETYPE <span class="string">"image/png"</span></div><div class="line">        IMAGEMODE RGB</div><div class="line">        EXTENSION <span class="string">"png"</span></div><div class="line">    END</div><div class="line"></div><div class="line">    <span class="comment"># Start of web interface definition</span></div><div class="line">    WEB</div><div class="line">        TEMPLATE /var/www/html/map/map.html</div><div class="line">        IMAGEPATH /var/www/html/map/images/</div><div class="line">        IMAGEURL /map/images/</div><div class="line">        LOG /var/www/html/map/maplog</div><div class="line">    END</div><div class="line"></div><div class="line">    <span class="comment"># Start of reference map 定义参考图（鹰眼图）</span></div><div class="line">    REFERENCE</div><div class="line">        IMAGE /var/www/html/map/data/efate.png</div><div class="line">        EXTENT <span class="number">196900</span> <span class="number">8027100</span> <span class="number">245000</span> <span class="number">8073000</span></div><div class="line">        STATUS ON</div><div class="line">        COLOR <span class="number">-1</span> <span class="number">-1</span> <span class="number">-1</span></div><div class="line">        OUTLINECOLOR <span class="number">255</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">        SIZE <span class="number">95</span> <span class="number">95</span></div><div class="line">    END</div><div class="line"></div><div class="line">    <span class="comment"># Start of legend 图例</span></div><div class="line">    LEGEND</div><div class="line">        KEYSIZE <span class="number">18</span> <span class="number">12</span></div><div class="line">        LABEL</div><div class="line">            TYPE BITMAP</div><div class="line">            SIZE MEDIUM</div><div class="line">            COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">89</span></div><div class="line">        END</div><div class="line">        STATUS ON</div><div class="line">    END</div><div class="line"></div><div class="line">    <span class="comment"># Start of scalebar 比例尺</span></div><div class="line">    SCALEBAR</div><div class="line">        IMAGECOLOR <span class="number">255</span> <span class="number">255</span> <span class="number">255</span></div><div class="line">        LABEL</div><div class="line">            COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>	</div><div class="line">            SIZE SMALL</div><div class="line">        END</div><div class="line">        SIZE <span class="number">350</span> <span class="number">5</span></div><div class="line">        COLOR <span class="number">255</span> <span class="number">255</span> <span class="number">255</span></div><div class="line">        BACKGROUNDCOLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">        OUTLINECOLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">        UNITS kilometers</div><div class="line">        INTERVALS <span class="number">5</span></div><div class="line">        STATUS ON</div><div class="line">    END</div><div class="line"></div><div class="line">    <span class="comment"># Start of query definitions 查询定义</span></div><div class="line">    QUERYMAP</div><div class="line">        STATUS ON</div><div class="line">        STYLE HILITE</div><div class="line">    END</div><div class="line">    </div><div class="line">4<span class="comment">#...</span></div><div class="line">4</div><div class="line">END <span class="comment">#  end of MAP</span></div></pre></td></tr></table></figure><p><strong>Tip: 一个快速使用 mapfile 的方法是直接应用上述内容，将 REFERENCE 部分中的图片指向真实内容. 这样就得到一个没有图层的mapfile文件。然后你可以往里面添加内容 ，根据你的需要进行修改.</strong><br>mapfile中下述内容的值必须准确设置才能工作:</p><p><strong><code>SHAPEPATH、IMAGEPATH、IMAGEURL、IMAGE</code></strong></p><h2 id="对象属性"><a href="#对象属性" class="headerlink" title="对象属性"></a>对象属性</h2><h3 id="MAP对象"><a href="#MAP对象" class="headerlink" title="MAP对象"></a>MAP对象</h3><blockquote><p><a href="http://mapserver.org/mapfile/map.html" target="_blank" rel="external">http://mapserver.org/mapfile/map.html</a></p></blockquote><h4 id="MAP对象的主要属性（MAP对象内部的LAYER对象等下文说明）："><a href="#MAP对象的主要属性（MAP对象内部的LAYER对象等下文说明）：" class="headerlink" title="MAP对象的主要属性（MAP对象内部的LAYER对象等下文说明）："></a>MAP对象的主要属性（MAP对象内部的LAYER对象等下文说明）：</h4><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">MAP</div><div class="line">4NAME <span class="string">"Efate"</span> <span class="comment"># map 文件名称</span></div><div class="line">4STATUS ON <span class="comment"># is this map on by default</span></div><div class="line">4SIZE <span class="number">400</span> <span class="number">400</span> <span class="comment"># 影像地图的像素大小 size in pixel of the image map</span></div><div class="line">4EXTENT <span class="number">196900</span> <span class="number">8027100</span> <span class="number">245000</span> <span class="number">8073000</span> <span class="comment"># 地图的地理范围 geographic extents of the map</span></div><div class="line">4UNITS METERS <span class="comment"># 地理范围的单位 units for the geographic extents</span></div><div class="line">4<span class="comment"># shapefile文件在服务器上的存储地址，同时作为参考目录使用 also used for directory reference</span></div><div class="line">    SHAPEPATH <span class="string">"/var/www/html/map/"</span></div><div class="line">4<span class="comment"># 输出影像的类型   24bits color PNG。PNG8 渲染速度比较快</span></div><div class="line">    IMAGETYPE png24 </div><div class="line">    <span class="comment"># 包含字体位置的文件 file containing the locations of fonts</span></div><div class="line">4FONTSET <span class="string">"fonts/fontset.txt"</span> </div><div class="line">    ...</div><div class="line">END</div></pre></td></tr></table></figure><ul><li><strong>NAME</strong> map相关的前缀，使用它来生成 scalebar 和 legend 的GIF 文件. 应该保持简短.</li><li><strong>SIZE</strong> <code>[x][y]</code> 输出影像（即地图）的像素的大小.</li><li><strong>EXTENT</strong><code>&lt;Lower Left X&gt; &lt;Lower Left Y&gt; &lt;Upper Right X&gt; &lt;Upper Right Y&gt;</code>：默认的地理坐标范围。可以使用<code>orginfo</code>获得矢量数据的四至，如<code>ogrinfo -al -so states_ugl.shp</code></li><li><strong>SHAPEPATH</strong>：文件目录（针对 shp 、tiff 等文件，非数据库或网络服务）。绝对路径 (如 <code>/ms4w/apps/tutorial/data</code> 或<code>C:/ms4w/apps/tutorial/data</code>) 或者相对 mapfile位置的路径 (如 ”../data”).</li><li><a href="http://mapserver.org/mapfile/web.html#web" target="_blank" rel="external">WEB</a> 对象，配置 MapServer 临时放置生成的地图图片的地址；</li><li><strong>UNITS</strong>： 地图坐标单位，用于比例尺 <code>[dd|feet|inches|kilometers|meters|miles|nauticalmiles]</code></li><li><strong>IMAGECOLOR</strong>，<code>[r][g][b]</code> ，设置地图的背景色，RGB；</li><li><strong>PROJECTION</strong>，地图使用的投影坐标系；</li><li><strong>SYMBOLSET</strong> ，指向符号定义文件，用于CLASS对象中的SYMBOL参数 <a href="http://mapserver.org/mapfile/symbology/construction.html#sym-construction" target="_blank" rel="external">Cartographic Symbol Reference</a></li></ul><h3 id="WEB对象"><a href="#WEB对象" class="headerlink" title="WEB对象"></a>WEB对象</h3><p>此对象内容定义了信息在服务器上存储的位置及其如何向浏览器提供服务</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">WEB</div><div class="line">  	<span class="comment"># location of the template for results</span></div><div class="line">4<span class="comment"># the line needs to be here, but it is not used (no file at this location)</span></div><div class="line">    TEMPLATE /var/www/html/map/map.html </div><div class="line">    <span class="comment"># 存放地图图片的位置，必须以“/”结尾</span></div><div class="line">  	IMAGEPATH /var/www/html/map/images/ </div><div class="line">4<span class="comment"># web path for the maps images</span></div><div class="line">  	IMAGEURL /map/images/ </div><div class="line">    <span class="comment"># 日志文件地址</span></div><div class="line">  	LOG /var/www/html/map/maplog </div><div class="line">END</div></pre></td></tr></table></figure><ul><li><strong>IAMGEPATH</strong>，存放生成的地图的图片和临时文件的路径；</li><li><strong>IMAGEURL</strong>，IMAGEPATH的<strong>基路径</strong>；</li><li><strong>METADATA</strong>，配置元数据，主要用来支持 OGC 的服务；</li></ul><h2 id="Projection"><a href="#Projection" class="headerlink" title="Projection"></a>Projection</h2><p><a href="http://mapserver.org/tutorial/example1-6.html" target="_blank" rel="external">http://mapserver.org/tutorial/example1-6.html</a></p><p>若定义了 PROJECTION 对象，则 MapServer 会将图层和投影信息传递给PROJ.4 库来进行重投影.</p><figure class="highlight yaml"><table><tr><td class="code"><pre><div class="line">PROJECTION</div><div class="line">    <span class="comment"># 采用的一种 PROJ.4 定义 of Lambert Azimuthal Equal-Area projection </span></div><div class="line">      <span class="string">"proj=laea"</span></div><div class="line">      <span class="string">"ellps=clrk66"</span></div><div class="line">      <span class="string">"lat_0=45"</span></div><div class="line">      <span class="string">"lon_0=-100"</span></div><div class="line">  END</div></pre></td></tr></table></figure><p>MapServer有两种定义投影的方式。</p><p>第一种如上例中，为传统的方式。</p><p>第二种是采用EPSG码，如</p><figure class="highlight yaml"><table><tr><td class="code"><pre><div class="line">PROJECTION</div><div class="line">4<span class="string">"init=epsg:2163"</span></div><div class="line">END</div></pre></td></tr></table></figure><p>map文件中定义的extent 的单位，必须和输出的投影的单位一致。因此，若之前采用的经纬度，则定义投影之后，需要修改extent的值。</p><p>可以使用 PROJ.4的 <code>cs2cs</code>命令来计算投影后地图的范围。</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cs2cs +proj=latlong +datum=WGS84 +to +proj=laea +ellps=clrk66 +lat_0=45 +lon_0=-100</div><div class="line"># 输入southwestern （lower left 左下角）的坐标</div><div class="line">-97.5 41.619778 # 空格分隔</div><div class="line">208398.01  -372335.44  0.000  # 输出的目标坐标值。第三个为高程值，此处可以忽略</div><div class="line"># northeastern coordinate pair (upper right 右上角坐标）</div><div class="line">-82.122902 49.38562 </div><div class="line">1285308.08   632638.93  0.000 # 输出的目标坐标值</div><div class="line"># 由于投影分带的问题，这里的坐标与实际中使用的坐标不一样</div></pre></td></tr></table></figure><p>在 MAP 对象头部中定义 PROJECTION 作为<strong>输出投影</strong>之后，需要在 LAYER 对象 中定义PROJECTION作为<strong>输入投影</strong></p><h3 id="LAYER对象"><a href="#LAYER对象" class="headerlink" title="LAYER对象"></a><a href="http://mapserver.org/mapfile/layer.html" target="_blank" rel="external">LAYER对象</a></h3><p>所有文件的位置必须是相对于<code>SHAPEPATH</code>所设置的路径 。若有文件为<code>/var/www/html/map/data/mylayer.shp</code> ，而 SHAPEPATH 的值为<code>/var/www/html/map/</code>，则文件位置必须设置为<code>data/mylayer.shp</code>. 采用这种规则能便于在使用<code>Maps-&gt;Layer Management</code>上传文件时定位到文件地址。<br>文件名都是<strong>大小写敏感</strong>的(包括扩展名)，并应该<strong>绝对禁止包含空格</strong>！A shapefile is usually made of a shp, idx, dbf files while a Mapinfo layer is made of TAB, ID, MAP, DAT (and sometimes IND) files.</p><p><strong><em>LAYER</em></strong> 表示<strong>图层数据源及其显示属性</strong>。在 <strong><em>LAYER</em></strong> 中存在一系列的属性，例如：</p><ul><li><strong>STATUS</strong>：图层允许显示(<strong><em>ON</em></strong>)、不显示(<strong><em>OFF</em></strong>)或强制显示(<strong><em>DEFAULT</em></strong>)</li><li><strong>TYPE</strong>：渲染对象的几何类型，如 POLYGON 、LINE 、 POINT 、RASTER、ANNOTATION</li><li><strong>DATA</strong>：所使用的源文件名称，如 shp 文件，或者 SQL 查询语句。支持的格式同 OGR。</li><li><strong>CLASS</strong>：渲染样式控制</li><li><strong>PROJECTION</strong>，字符串，图层数据所在的坐标系；</li><li><strong>METADATA</strong>，要配置的服务的配置对象；</li><li><strong>CONNECTIONTYPE</strong>，连接的类型，默认是本地，也就是本地磁盘文件；</li><li><strong>CONNECTION</strong>，连接数据库的字符串，或者WMS等的URL，在图层数据在数据库中时候才会使用；在map文件中，必须<strong>单独成行</strong>（the string has to be in a single line in mapfile ）</li></ul><h4 id="Vector-layer"><a href="#Vector-layer" class="headerlink" title="Vector layer"></a>Vector layer</h4><h5 id="Shapefile"><a href="#Shapefile" class="headerlink" title="Shapefile"></a>Shapefile</h5><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">  NAME <span class="string">"My Layer"</span></div><div class="line">  TYPE LINE</div><div class="line">  STATUS ON</div><div class="line">  DATA <span class="string">"data/myshapefile.shp"</span></div><div class="line">  CLASS</div><div class="line">    COLOR <span class="number">255</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">    NAME <span class="string">"My layer legend"</span></div><div class="line">  END <span class="comment"># end of class</span></div><div class="line">END <span class="comment"># end of layer</span></div></pre></td></tr></table></figure><blockquote><p>“My layer legend” in the LEGEND.</p></blockquote><h5 id="Mapinfo-TAB"><a href="#Mapinfo-TAB" class="headerlink" title="Mapinfo TAB"></a>Mapinfo TAB</h5><p>The difference with a shapefile is the use of the OGR library to read the Mapinfo files. The keyword CONNECTIONTYPE OGR must be used and the location of the file is given by the keyword CONNECTION instead of DATA. All the rest stay the same.</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">  NAME <span class="string">"My Layer"</span></div><div class="line">  TYPE LINE</div><div class="line">  STATUS ON</div><div class="line">  CONNECTIONTYPE OGR</div><div class="line">  CONNECTION <span class="string">"data/mymapinfofile.TAB"</span></div><div class="line">  CLASS</div><div class="line">    COLOR <span class="number">255</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">    NAME <span class="string">"My layer legend"</span></div><div class="line">  END <span class="comment"># end of class</span></div><div class="line">END <span class="comment"># end of layer</span></div></pre></td></tr></table></figure><h4 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h4><p>To make the layer queryable add anywehere inside the LAYER object the following lines:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">TEMPLATE &quot;query.html&quot;</div><div class="line">TOLERANCE 3</div><div class="line">TOLERANCEUNITS PIXELS</div></pre></td></tr></table></figure><p>第一个参数是必须的，但是并不一定需要指向一个真实的文件（ does not need to pint to a real file）. It is only used outsied tikimaps. The second parameters specify the pointing TOLERANCE in TOLERANCEUNITS, here 3 pixels. If you click on the map all the objects from this layer which are at less than 3 pixels from the click on the image will be selected.<br>The map is then redraw and at the bottom of the page will be the information related from the object.<br>Note: if you create a GIS layer which fields contain HTML tags, like for IMG or A (anchor/link), they will be rendered accordingly. This allows you to create a layer pointing to images stored on Tiki.</p><p>###STYLE</p><p><strong>COLOR</strong></p><p>多边形的填充色、线的颜色. RGB 格式.</p><p><strong>OUTLINECOLOR</strong></p><p>多边形边线的颜色. RGB 格式. MapServer 默认不绘制多边形的边线，需要设置此属性的值才能看到.</p><p>###Label</p><p><a href="http://mapserver.org/tutorial/example1-4.html" target="_blank" rel="external">http://mapserver.org/tutorial/example1-4.html</a></p><p>从图层的属性中选择一个字段用于在地图上显示。例如，若有一个GIS图层包含国家的名称，对应的字段为 “NAME”，则可以使用<code>LABELITEM &quot;NAME&quot;</code>来告诉 mapserver 将其值显示在地图上.<br>在 CLASS 对象里面, 应当设置这些标注如何渲染.</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">  NAME <span class="string">"Country Names"</span></div><div class="line">  TYPE POINT</div><div class="line">  STATUS ON</div><div class="line">  METADATA</div><div class="line">     DOWNLOAD <span class="string">"T"</span></div><div class="line">  END</div><div class="line">  LABELITEM <span class="string">"NAME"</span></div><div class="line">  LABELCACHE ON</div><div class="line">  CONNECTIONTYPE OGR</div><div class="line">  CONNECTION <span class="string">"data/Country.TAB"</span></div><div class="line">  CLASS</div><div class="line">     SYMBOL <span class="number">0</span></div><div class="line">     COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">     NAME <span class="string">"Country Names"</span></div><div class="line">     LABEL</div><div class="line">        COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">        FONT arial</div><div class="line">        TYPE TRUETYPE <span class="comment"># 字体的类型 TRUETYPE、BITMAP</span></div><div class="line">        POSITION CC <span class="comment"># C for center, U for upper, and L for lower，或使用 auto </span></div><div class="line">        PARTIALS TRUE</div><div class="line">        ANTIALIAS TRUE <span class="comment"># 是否启用Truetype字体的抗锯齿效果</span></div><div class="line">        MINDISTANCE <span class="number">300</span> <span class="comment"># 相同标注之间的最小距离。设置的比较大能够避免过于拥挤</span></div><div class="line">        SIZE <span class="number">7</span></div><div class="line">        BUFFER <span class="number">1</span> <span class="comment"># padding</span></div><div class="line">        OUTLINECOLOR <span class="number">255</span> <span class="number">255</span> <span class="number">255</span></div><div class="line">     END							     </div><div class="line">  END</div><div class="line">END</div></pre></td></tr></table></figure><p>上例中， LABEL 为黑色 (COLOR 0 0 0) 并使用 TRUETYPE 字体 arial . 标注的 POSITION 为相对于POINT 对象的 Center/Center . 若一个对象并不完全在地图上，其标注也会显示出来 (PARTIAL TRUE). 标注的 SIZE 为7 points. 标注之间的距离不会小于 1 个像素 (BUFFER 1). 为了让最后一个参数能够正常作用，应该启用 LABELCACHE. 最后，标注对象有一个白色的边界 (OUTLINECOLOR 255 255 255).</p><p>还可以设置</p><ul><li>MINFEATURESIZE 显示标签所需的最小目标要素的面积像素值。</li><li>MINSIZE 标签大小的最小像素值</li></ul><p>###Thematic Mapping</p><p>每个 layer 包括一个或多个 CLASS. CLASS 定义了如何在屏幕上绘制每个对象。 通过使用 CLASSITEM, 你可以使用一个字段来将同一类的不同对象区分开。例如，所有深度为 -100m 到 -500m的等深线属于一类，而-500m 到-1000m 的等深线属于另一类. 这种划分在CLASS里面是通过使用 EXPRESSION 实现的. EXPRESSION 使用基于CLASSITEM中字段的简单逻辑实现。<br>例如，使用表示 LINE 对象水深值的字段”value”，根据深度值的不同显示不同的颜色。若 EXPRESSION 为 true ，则 CLASS 中的参数会被应用. 一个没有EXPRESSION 的 CLASS 将被作为未被划分的对象的默认CLASS .</p><p>通过<code>ogrinfo</code>，或者其他程序查看shapefile文件中的 dbf 文件，可以确定 数据中包含的属性，用来定义 CLASSITEM。</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">  NAME <span class="string">"Bathymetry 20m"</span></div><div class="line">  TYPE LINE</div><div class="line">  STATUS OFF</div><div class="line">  METADATA</div><div class="line">    WIKI <span class="string">"FijiBathymetry"</span></div><div class="line">  END</div><div class="line">  TEMPLATE <span class="string">"query.html"</span></div><div class="line">  TOLERANCE <span class="number">3</span></div><div class="line">  TOLERANCEUNITS PIXELS</div><div class="line">  LABELITEM <span class="string">"Value"</span></div><div class="line">  CLASSITEM <span class="string">"Value"</span></div><div class="line">  LABELCACHE ON</div><div class="line">  CONNECTIONTYPE OGR</div><div class="line">  CONNECTION <span class="string">"data/fiji/viti_bathy_contour.TAB"</span></div><div class="line">  CLASS</div><div class="line">    SYMBOL <span class="number">0</span></div><div class="line">    COLOR <span class="number">0</span> <span class="number">200</span> <span class="number">255</span></div><div class="line">    NAME <span class="string">"Bathymetry 2.5m &gt;-50m"</span></div><div class="line">    expression ([Value]&gt;<span class="number">-50</span>)</div><div class="line">    LABEL</div><div class="line">      ANGLE AUTO</div><div class="line">      COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">      FONT arial</div><div class="line">      TYPE TRUETYPE</div><div class="line">      POSITION cc</div><div class="line">      PARTIALS FALSE</div><div class="line">      BUFFER <span class="number">5</span></div><div class="line">      SIZE <span class="number">6</span></div><div class="line">      OUTLINECOLOR <span class="number">200</span> <span class="number">200</span> <span class="number">200</span></div><div class="line">    END</div><div class="line">  END</div><div class="line">  CLASS</div><div class="line">    SYMBOL <span class="number">0</span></div><div class="line">    COLOR <span class="number">0</span> <span class="number">100</span> <span class="number">255</span></div><div class="line">    NAME <span class="string">"Bathymetry 20m &gt;-500m"</span></div><div class="line">    expression ([Value]&lt;<span class="number">-50</span> AND [Value]&gt;=<span class="number">-500</span>)</div><div class="line">    LABEL</div><div class="line">      ANGLE AUTO</div><div class="line">      FONT arial</div><div class="line">      COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">      TYPE TRUETYPE</div><div class="line">      POSITION cc</div><div class="line">      PARTIALS FALSE</div><div class="line">      BUFFER <span class="number">5</span></div><div class="line">      SIZE <span class="number">6</span></div><div class="line">      OUTLINECOLOR <span class="number">200</span> <span class="number">200</span> <span class="number">200</span></div><div class="line">    END</div><div class="line">  END</div><div class="line">END</div></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="code"><pre><div class="line">MAP</div><div class="line">  IMAGETYPE      PNG</div><div class="line">  EXTENT         <span class="bullet">-97.238976</span> <span class="number">41.619778</span> <span class="bullet">-82.122902</span> <span class="number">49.385620</span></div><div class="line">  SIZE           <span class="number">400</span> <span class="number">300</span></div><div class="line">  SHAPEPATH      <span class="string">"../data"</span></div><div class="line">  IMAGECOLOR     <span class="number">255</span> <span class="number">255</span> <span class="number">255</span></div><div class="line">  LAYER </div><div class="line">    NAME         states_poly</div><div class="line">    DATA         states_ugl</div><div class="line">    STATUS       OFF</div><div class="line">    TYPE         POLYGON</div><div class="line">    CLASSITEM    <span class="string">"CLASS"</span></div><div class="line">    CLASS</div><div class="line">      NAME <span class="string">'States'</span></div><div class="line">      EXPRESSION <span class="string">'land'</span> <span class="comment"># Only polygons where "CLASS" = 'land' will be drawn.</span></div><div class="line">      STYLE</div><div class="line">        COLOR      <span class="number">232</span> <span class="number">232</span> <span class="number">232</span></div><div class="line">      END</div><div class="line">    END</div><div class="line">    CLASS</div><div class="line">      NAME <span class="string">'Water'</span></div><div class="line">      EXPRESSION <span class="string">'water'</span> <span class="comment"># Only polygons where "CLASS" = 'water' will be drawn.</span></div><div class="line">      STYLE</div><div class="line">        COLOR      <span class="number">198</span> <span class="number">198</span> <span class="number">255</span></div><div class="line">      END</div><div class="line">    END</div><div class="line">  END </div><div class="line">END</div></pre></td></tr></table></figure><h3 id="Metadata"><a href="#Metadata" class="headerlink" title="Metadata"></a>Metadata</h3><p>在一个 LAYER 组内，可以定义一个（且仅有一个） METADATA 组. 部分 metadata 在tikiwiki中有特殊用途.</p><h4 id="WIKI"><a href="#WIKI" class="headerlink" title="WIKI"></a>WIKI</h4><p>实验WIKI 根据图层名生成一个链接到wiki页面的链接。 使用wiki页来说明图层信息:<br>custodian、所有者、创建日期、精度、历史、基准/投影、interesting layer features…</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">METADATA</div><div class="line"> 	WIKI <span class="string">"MyLayerPage"</span></div><div class="line">END</div></pre></td></tr></table></figure><p>###Raster layer</p><blockquote><p><a href="http://mapserver.org/tutorial/example1-5.html" target="_blank" rel="external">http://mapserver.org/tutorial/example1-5.html</a></p></blockquote><p>最简单的处理栅格图层的方式是使用包含投影信息的 Geotiff 图像. 但是生成 geotiff 图像可能需要其他遥感软件. 另一种方式是使用一个额外的包含图像像素坐标信息的文件。<br>当使用多个图像，而不是每个图像作为一个图层时，这些图像会被平铺（tiled）. 将为每个图像生成一个 包含矩形的shapefile 来帮助系统准确定位图像.</p><h5 id="Geotiff"><a href="#Geotiff" class="headerlink" title="Geotiff"></a>Geotiff</h5><p>设置 TYPE 为 RASTER， 并设置 DATA 指向 tiff 文件即可. 关键词 OFFSITE 用于指定tiff图像中透明部分的颜色. 这在拼接（tiling ）或叠加（overlapping ）多个影像时很有用。</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">  NAME <span class="string">"DTM 50m"</span></div><div class="line">  TYPE RASTER</div><div class="line">  STATUS OFF</div><div class="line">  DATA <span class="string">"data/fiji/VLevudtm.tif"</span></div><div class="line">  OFFSITE <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">  PROCESSING <span class="string">"BANDS=1,2,3"</span>  <span class="comment"># 此处选择多光谱影像中需要显示的波段</span></div><div class="line">END</div></pre></td></tr></table></figure><p>PROCESSING 指定处理指令，参考 <a href="http://mapserver.org/mapfile/layer.html#layer" target="_blank" rel="external">http://mapserver.org/mapfile/layer.html#layer</a></p><h5 id="Image-Tiles"><a href="#Image-Tiles" class="headerlink" title="Image Tiles"></a>Image Tiles</h5><p>Images tiles are created using utility tools from the mapserver software. The utility is called gdaltindex and parses mainly geotiff images to get their boundaries and create a shapefile containing an outline for each of the images. Under Maps-&gt;Layer Management, at the bottom of the page a utility is avalilable to generate the shapefile. Basically upload the images to the right directory. The images should have the same name prefix. Then reference all these images with a wildcaard and name the shapefile to be created. For instance you can upload coralcoastsigatoka.tif, coralcoastmomi.tif, coralcoastnavua.tif and reference them as coralcoast*.tif and create the shapefile img_index.shp</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">  NAME <span class="string">"Coral Coast 4m IKONOS"</span></div><div class="line">  TYPE RASTER</div><div class="line">  METADATA</div><div class="line">    WIKI <span class="string">"FijiImagery"</span></div><div class="line">  END</div><div class="line">  STATUS ON</div><div class="line">  TILEINDEX <span class="string">"data/fiji/img_index.shp"</span></div><div class="line">  TILEITEM <span class="string">"Location"</span></div><div class="line">  OFFSITE <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">END</div></pre></td></tr></table></figure><h4 id="Grid-Layer"><a href="#Grid-Layer" class="headerlink" title="Grid Layer"></a>Grid Layer</h4><p>A grid layer allows you to draw a grid in the local cordinates on your map. It is useful to find location of objects on the map. For best effect the grid must be the last layer in the mapfile to be drawn the last.</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">  NAME <span class="string">"Grid"</span></div><div class="line">  TYPE LINE</div><div class="line">  STATUS OFF</div><div class="line">  CLASS</div><div class="line">    COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">    LABEL</div><div class="line">      FONT arial     <span class="comment"># must be in your FONTSET</span></div><div class="line">      TYPE TRUETYPE</div><div class="line">      SIZE <span class="number">8</span></div><div class="line">      COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">      OUTLINECOLOR <span class="number">255</span> <span class="number">255</span> <span class="number">255</span></div><div class="line">    END</div><div class="line">  END</div><div class="line">  GRID</div><div class="line">    MINARCS <span class="number">2</span></div><div class="line">    MAXARCS <span class="number">6</span></div><div class="line">  END</div><div class="line">END</div></pre></td></tr></table></figure><h3 id="WMS图层"><a href="#WMS图层" class="headerlink" title="WMS图层"></a>WMS图层</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><div class="line">LAYER</div><div class="line">    NAME         modis_jpl</div><div class="line">    TYPE         RASTER</div><div class="line">    OFFSITE      <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">    STATUS       OFF</div><div class="line">    CONNECTIONTYPE WMS</div><div class="line">    CONNECTION <span class="string">"http://wms.jpl.nasa.gov/wms.cgi?"</span></div><div class="line"></div><div class="line">    METADATA</div><div class="line">      <span class="string">"wms_srs"</span> <span class="string">"EPSG:4326"</span></div><div class="line">      <span class="string">"wms_name"</span> <span class="string">"modis"</span></div><div class="line">      <span class="string">"wms_server_version"</span> <span class="string">"1.1.1"</span></div><div class="line">      <span class="string">"wms_format"</span> <span class="string">"image/jpeg"</span></div><div class="line">    END</div><div class="line"></div><div class="line">    PROJECTION</div><div class="line">      <span class="string">"init=epsg:4326"</span></div><div class="line">    END</div><div class="line">END</div></pre></td></tr></table></figure><h3 id="DOWNLOAD"><a href="#DOWNLOAD" class="headerlink" title="DOWNLOAD"></a>DOWNLOAD</h3><p>若 DOWNLOAD 被设置为 “T”，那么组成此图层的文件将可以被注册用户下载 .</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">METADATA</div><div class="line"> DOWNLOAD <span class="string">"T"</span></div><div class="line">END</div></pre></td></tr></table></figure><p>The system selects all the files with the same base name as defined in the LAYER DATA or CONNECTION clause but with different extension. However if one of these files has the extension NDL, the download is disabled. This allows to upload GIS data that can only be viewable.</p><h3 id="Reference对象（鹰眼）"><a href="#Reference对象（鹰眼）" class="headerlink" title="Reference对象（鹰眼）"></a>Reference对象（鹰眼）</h3><p>这部分内容定义了如何显示一个概略图（鹰眼图）. 可以用一个图片来表示感兴趣的区域，并指定边界的坐标. 系统将会基于当前的视图，在图片上绘制一个矩形来标识视图的边界。</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">REFERENCE</div><div class="line">  IMAGE /var/www/html/map/data/efate.png <span class="comment"># location of the image</span></div><div class="line">  EXTENT <span class="number">196900</span> <span class="number">8027100</span> <span class="number">245000</span> <span class="number">8073000</span> <span class="comment"># extent of the image</span></div><div class="line">  STATUS ON <span class="comment"># the overview is on by default</span></div><div class="line">  COLOR <span class="number">-1</span> <span class="number">-1</span> <span class="number">-1</span> <span class="comment"># 透明背景</span></div><div class="line">  OUTLINECOLOR <span class="number">255</span> <span class="number">0</span> <span class="number">0</span> <span class="comment"># 边线的颜色</span></div><div class="line">  SIZE <span class="number">95</span> <span class="number">95</span> <span class="comment"># 图像大小，像素</span></div><div class="line">END</div></pre></td></tr></table></figure><p>The tip to create an image for overview, is to not worry about the image at the begining. Any image will do. When the layers are implemented in the mapfile and the main view sounds pretty enough, then select a default view, click <em>Redraw</em> if neccessary to get the minx, maxx, miny, maxy parameters in the URL, (if necessary adjust them manualy). Save the current map as an image onto your local machine, use an image editing software to resize the image to the size you want to use in the overview (here 95x95 pixel). Upload the image using the <em>maps-&gt;layer manager</em> and update the IMAGE link in the REFERENCE group to point to this new image. Finish by entering the correct EXTENTS that corresponds to the minx,miny,maxx,maxy of the map you used to create the overview.</p><h3 id="Legend"><a href="#Legend" class="headerlink" title="Legend"></a>Legend</h3><p>The legend is linked to each LAYER by the way each object type is represented (POINT, LINE, POLYGON,…) and its COLOR and OUTLINECOLOR and by the NAME used in the CLASS group. It is important to have a meaningful NAME for each CLASS group in every LAYER group. The NAME of the CLASS can be different from the NAME of the layer as a LAYER can have several CLASSes.</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">LEGEND</div><div class="line">  <span class="comment"># the size of the object representing the geographical object</span></div><div class="line">  KEYSIZE <span class="number">18</span> <span class="number">12</span></div><div class="line">  LABEL</div><div class="line">    <span class="comment"># Font type for the legend name of each geographical object</span></div><div class="line">    TYPE BITMAP</div><div class="line">4<span class="comment"># font size</span></div><div class="line">    SIZE MEDIUM</div><div class="line">4<span class="comment"># font color</span></div><div class="line">    COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">89</span>	</div><div class="line">  END</div><div class="line">  <span class="comment"># legend is on by default</span></div><div class="line">  STATUS ON	</div><div class="line">END</div></pre></td></tr></table></figure><h3 id="Scalebar"><a href="#Scalebar" class="headerlink" title="Scalebar"></a>Scalebar</h3><p>显示比例尺以获取距离信息.</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">SCALEBAR</div><div class="line">  IMAGECOLOR <span class="number">255</span> <span class="number">255</span> <span class="number">255</span> <span class="comment"># 比例尺占位图片的背景色 background color of the image placeholder</span></div><div class="line">  LABEL</div><div class="line">    COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>	<span class="comment"># 表示距离的标签的文字颜色 color of the labels indicating the distance</span></div><div class="line">    SIZE SMALL <span class="comment"># 标签大小</span></div><div class="line">  END</div><div class="line">  SIZE <span class="number">350</span> <span class="number">5</span> <span class="comment"># 比例尺的像素大小 </span></div><div class="line">  COLOR <span class="number">255</span> <span class="number">255</span> <span class="number">255</span> <span class="comment"># 比例尺颜色 </span></div><div class="line">  BACKGROUNDCOLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="comment"># 比例尺的背景色</span></div><div class="line">  OUTLINECOLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="comment"># 比例尺外边界颜色</span></div><div class="line">  UNITS kilometers <span class="comment"># 比例尺单位</span></div><div class="line">  INTERVALS <span class="number">5</span> <span class="comment"># 比例尺中总的间隔数 How many intervals in total in the scalebar</span></div><div class="line">  STATUS ON <span class="comment"># 默认启用</span></div><div class="line">END</div></pre></td></tr></table></figure><h3 id="QUERYMAP"><a href="#QUERYMAP" class="headerlink" title="QUERYMAP"></a>QUERYMAP</h3><p>此部分内容用于设置地图为 <strong>可查询的</strong>，以及查询的结果如何显示。即使现在没有可查询的LAYER，也建议包含此部分内容，因为迟早会有这样的需求。</p><figure class="highlight python"><table><tr><td class="code"><pre><div class="line">QUERYMAP</div><div class="line">  STATUS ON <span class="comment"># 地图默认可查询</span></div><div class="line">  STYLE HILITE <span class="comment"># 高亮显示选中对象</span></div><div class="line">END</div></pre></td></tr></table></figure><h2 id="OUTPUTFORMAT"><a href="#OUTPUTFORMAT" class="headerlink" title="OUTPUTFORMAT"></a><a href="http://mapserver.org/mapfile/outputformat.html" target="_blank" rel="external">OUTPUTFORMAT</a></h2><p>一个map文件可有一个或多个OUTPUTFORMAT 对象，用于定义可用的输出格式，如 PNG, GIF, JPEG, GeoTIFF, SVG, PDF 和 KML 等. pdf 和 svg 依赖 cairo</p><figure class="highlight yaml"><table><tr><td class="code"><pre><div class="line">OUTPUTFORMAT</div><div class="line">  NAME <span class="string">"png"</span></div><div class="line">  DRIVER AGG/PNG </div><div class="line">  MIMETYPE <span class="string">"image/png"</span></div><div class="line">  IMAGEMODE RGB <span class="comment"># [PC256|RGB|RGBA|INT16|FLOAT32|FEATURE]</span></div><div class="line">  EXTENSION <span class="string">"png"</span></div><div class="line">  FORMATOPTION <span class="string">"GAMMA=0.75"</span></div><div class="line">END</div></pre></td></tr></table></figure><p>driver： AGG/PNG 、 AGG/PNG8、AGG/JPEG、 OGR/Mapinfo File、CAIRO/SVG、CAIRO/PDF、CAIRO/PNG、GDAL/GTiff 、KML, KMZ 和 UTFGRID</p><p>FORMATOPTION ：Provides a driver or format specific option. 在一个 OUTPUTFORMAT 中可以有一个或多个 FORMATOPTION 声明 (optional)</p><h2 id="带注释示例"><a href="#带注释示例" class="headerlink" title="带注释示例"></a>带注释示例</h2><blockquote><p><a href="http://geomatica.como.polimi.it/corsi/geog_info_system/3_MapfileETHEX_10-11.pdf" target="_blank" rel="external">Editing the mapfile for a MapServer-based webGIS</a></p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="comment"># ethex.map (with full comments)</span></div><div class="line"><span class="comment"># 此处为 Map 对象定义起始</span></div><div class="line"><span class="comment"># First piece of information is about general characteristics of the map we want</span></div><div class="line"><span class="comment"># to create.</span></div><div class="line"><span class="comment"># It starts with the MAP keyword and finishes with the END keyword.</span></div><div class="line">MAP</div><div class="line">4<span class="comment"># 地图的名称</span></div><div class="line">4NAME <span class="string">"ethex"</span>	</div><div class="line">4<span class="comment"># 地图的地理范围: it is the first extension the webGIS will display</span></div><div class="line">4EXTENT <span class="number">1486000</span> <span class="number">5056000</span> <span class="number">1525000</span> <span class="number">5088000</span>	</div><div class="line">4<span class="comment"># 分辨率 (pixels) of the window where the map will be drawn in</span></div><div class="line">4SIZE <span class="number">500</span> <span class="number">400</span>	</div><div class="line">4<span class="comment"># 数据源路径</span></div><div class="line">4<span class="comment"># (NOTE! here the path is from the mapfile 此处路径从 mapfile 位置开始算)</span></div><div class="line">4SHAPEPATH <span class="string">"data/shpf"</span>	</div><div class="line">4<span class="comment"># 图形符号定义文件路径</span></div><div class="line">4<span class="comment"># (NOTE! 此处路径从 mapfile 位置开始算)</span></div><div class="line">4SYMBOLSET <span class="string">"graphics/symbols/Symbols.sym"</span></div><div class="line">4<span class="comment"># 包含 TrueType 字体定义的文件路径</span></div><div class="line">4<span class="comment"># (NOTE! here the path is from the mapfile)</span></div><div class="line">4FONTSET <span class="string">"graphics/fonts/fontset.txt"</span>	</div><div class="line">4<span class="comment"># 地图图片背景色</span></div><div class="line">4<span class="comment"># (R G B colour model)</span></div><div class="line">4IMAGECOLOR <span class="number">175</span> <span class="number">175</span> <span class="number">175</span>	</div><div class="line">4<span class="comment"># 单位 Geographic units</span></div><div class="line">4UNITS meters 	</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># Web 对象定义.</span></div><div class="line">4 <span class="comment"># It defines how the interface (template file) has to operate.</span></div><div class="line">4 <span class="comment"># 以 WEB 关键字开始以 END 关键字结束.</span></div><div class="line">4 <span class="comment"># Web 对象包含在 Map 对象里面 ( Map 对象的子对象)</span></div><div class="line">4 </div><div class="line">4 WEB</div><div class="line">4 	<span class="comment"># Path of the folder where MapServer writes temporary files</span></div><div class="line">4 	<span class="comment"># (NOTE! here the path is absolute)</span></div><div class="line">4 	IMAGEPATH <span class="string">"/usr/local/mapserver_tmp/"</span>	 	</div><div class="line">4 	<span class="comment"># Web path of the folder where MapServer writes temporary files</span></div><div class="line">4 	<span class="comment"># (NOTE! here the path is from the web root (E.g. from htdocs for</span></div><div class="line">4 	<span class="comment"># Apache web servers))</span></div><div class="line">4 	IMAGEURL <span class="string">"/tmp/"</span>	 	</div><div class="line">4 	<span class="comment"># 主模板文件名称  Name of the main template file</span></div><div class="line">4 	TEMPLATE <span class="string">"ethex.html"</span></div><div class="line">4 END	 </div><div class="line">4 <span class="comment"># Projection （投影）对象定义.</span></div><div class="line">4 <span class="comment"># 此处定义了地图的全局投影系统（ global CRS（Coordinate Reference System））  </span></div><div class="line">4 PROJECTION</div><div class="line">4 	<span class="comment"># 地图 CRS 的 EPSG 代码  </span></div><div class="line">4 	<span class="string">"init=epsg:3003"</span></div><div class="line">4 END</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># Reference 对象.</span></div><div class="line">4 <span class="comment"># 定义参考地图 reference map (鹰眼地图 overview map). </span></div><div class="line">4 REFERENCE</div><div class="line">4 	<span class="comment"># 状态 (值: ON 或 OFF)</span></div><div class="line">4 	STATUS on</div><div class="line">4 	<span class="comment"># 参考图图片文件路径</span></div><div class="line">4 	<span class="comment"># (NOTE! path is from the mapfile)</span></div><div class="line">4 	IMAGE <span class="string">"graphics/refmap/refmap.png"</span></div><div class="line">4 	</div><div class="line">4 	<span class="comment"># 窗口屏幕分辨率 (pixels) reference map</span></div><div class="line">4 	SIZE <span class="number">183</span> <span class="number">150</span></div><div class="line">4 	</div><div class="line">4 	<span class="comment"># 参考图地理范围</span></div><div class="line">4 	EXTENT <span class="number">1486000</span> <span class="number">5056000</span> <span class="number">1525000</span> <span class="number">5088000</span></div><div class="line">4 	</div><div class="line">4 	<span class="comment"># 表示主图显示范围的鹰眼图上方框填充颜色</span></div><div class="line">4 	<span class="comment">#  (值 -1 -1 -1 表示透明色)</span></div><div class="line">4 	COLOR <span class="number">-1</span> <span class="number">-1</span> <span class="number">-1</span></div><div class="line">4 </div><div class="line">4 	<span class="comment"># 方框线的颜色</span></div><div class="line">4 	OUTLINECOLOR <span class="number">255</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">4 END</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># Querymap 对象.</span></div><div class="line">4 <span class="comment"># 定义了 query map (显示查询结果的地图 map drawn to display query results).</span></div><div class="line">4 QUERYMAP</div><div class="line">4 	<span class="comment"># (值: ON or OFF) </span></div><div class="line">4 	STATUS on</div><div class="line">4 	</div><div class="line">4 	<span class="comment"># 用于高亮显示查询结果颜色的颜色</span></div><div class="line">        <span class="comment"># Colour used to highlight queried features (默认: yellow)</span></div><div class="line">4 	COLOR <span class="number">255</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">4 	</div><div class="line">4 	<span class="comment"># STYLE 如何高亮（下划线）显示结果要素的样式</span></div><div class="line">4 	<span class="comment"># 	hilite: 以COLOR定义的颜色为下划线显示结果要素 underlined ; 其他正常显示</span></div><div class="line">4 	<span class="comment"># 	normal: 正常显示，与未查询的要素一样</span></div><div class="line">4 	<span class="comment">#   selected: 查到的要素正常显示，其他要素不显示</span></div><div class="line">4 	STYLE hilite</div><div class="line">4 END</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># Legend 图例对象.</span></div><div class="line">4 <span class="comment"># static legend.</span></div><div class="line">4 LEGEND</div><div class="line">4 	<span class="comment">#  ON or OFF</span></div><div class="line">4 	STATUS on	 	</div><div class="line">4 	<span class="comment"># 图例背景色</span></div><div class="line">4 	IMAGECOLOR <span class="number">255</span> <span class="number">255</span> <span class="number">255</span>	 	</div><div class="line">4 	<span class="comment"># 图例符号Dimensions of the legend symbols (in pixels) 默认= 20 x 10</span></div><div class="line">4 	KEYSIZE <span class="number">18</span> <span class="number">12</span>	 	</div><div class="line">4 	<span class="comment"># Here starts the definition of the Label Object. The Label Object defines the</span></div><div class="line">4 	<span class="comment"># characteristics of the legend symbols.</span></div><div class="line">4 	LABEL </div><div class="line">4 		<span class="comment"># Here there is the definition of the font to be used; Generally bitmap fonts</span></div><div class="line">4 		<span class="comment"># are faster to be drawn than TrueType fonts. But TrueType fonts are scalable</span></div><div class="line">4 		<span class="comment"># and available in a variety of faces.</span></div><div class="line">4 		<span class="comment"># When truetype is selected the FONT parameter must be also defined.</span></div><div class="line">4 		TYPE truetype</div><div class="line">4 		FONT <span class="string">"courier"</span>	 		</div><div class="line">4 		<span class="comment"># 文本大小.</span></div><div class="line">4 		<span class="comment"># It has to be defined has: [integer] for truetype type</span></div><div class="line">4 		<span class="comment"># [tiny|small|medium|large|giant] for bitmap type.</span></div><div class="line">4 		SIZE <span class="number">10</span>	 		</div><div class="line">4 		<span class="comment"># As an alternative</span></div><div class="line">4 		<span class="comment"># TYPE bitmap</span></div><div class="line">4 		<span class="comment"># SIZE small (o giant o medium)</span></div><div class="line">4 		<span class="comment"># Here we define the color used</span></div><div class="line">4 		COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">130</span></div><div class="line">4 	END</div><div class="line">4 END</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># 比例尺对象 Scalebar Object.</span></div><div class="line">4 SCALEBAR</div><div class="line">44<span class="comment"># Status of the scalebar (values: ON or OFF)</span></div><div class="line">44STATUS on		</div><div class="line">44<span class="comment"># Color to be used for odd intervals</span></div><div class="line">44COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> 	</div><div class="line">44<span class="comment">#Color to be used for outlining individual intervals</span></div><div class="line">44OUTLINECOLOR <span class="number">50</span> <span class="number">50</span> <span class="number">50</span>		</div><div class="line">44<span class="comment"># Color to be used for even intervals</span></div><div class="line">44BACKGROUNDCOLOR <span class="number">255</span> <span class="number">255</span> <span class="number">224</span>		</div><div class="line">44<span class="comment"># Background color for the scalebar</span></div><div class="line">44IMAGECOLOR <span class="number">215</span> <span class="number">215</span> <span class="number">200</span>		</div><div class="line">44<span class="comment"># Output scale bar units ([feet|inches|kilometers|meters|miles)</span></div><div class="line">44UNITS kilometers		</div><div class="line">44<span class="comment"># Number of intervals of the scalebar(integer)</span></div><div class="line">44INTERVALS <span class="number">4</span>		</div><div class="line">44<span class="comment"># Scalebar image size(in pixel)</span></div><div class="line">44SIZE <span class="number">200</span> <span class="number">2</span>		</div><div class="line">44<span class="comment"># Scalebar style: (available values: 0,1)</span></div><div class="line">44STYLE <span class="number">0</span>		</div><div class="line">44<span class="comment"># Here starts the definition of the Label Object. The Label Object defines the</span></div><div class="line">44<span class="comment"># characteristics of the scalebar symbols.</span></div><div class="line">44LABEL</div><div class="line">444TYPE bitmap</div><div class="line">444SIZE small</div><div class="line">444COLOR <span class="number">50</span> <span class="number">50</span> <span class="number">50</span></div><div class="line">44END</div><div class="line">44<span class="comment"># As an alternative:</span></div><div class="line">44<span class="comment"># LABEL</span></div><div class="line">444<span class="comment"># TYPE BITMAP</span></div><div class="line">444<span class="comment"># SIZE tiny</span></div><div class="line">444<span class="comment"># COLOR 255 0 0</span></div><div class="line">44<span class="comment"># END</span></div><div class="line">4 END </div><div class="line">4</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># Layer Object. The Layer Object determines the make-up of</span></div><div class="line">4 <span class="comment"># a specific cartographic layer in the map. Layers are drawn in their order of</span></div><div class="line">4 <span class="comment"># appearance in the MapFile (显示时，第一个图层在最下面，最后的图层在最上面).</span></div><div class="line">4 <span class="comment"># 每个 mapfile 最多 50 个图层.</span></div><div class="line">4 <span class="comment"># This can be changed by editing the map.h file to change the value of</span></div><div class="line">4 <span class="comment"># MS_MAXLAYERS to the desired number and recompiling Mapserver.</span></div><div class="line">    </div><div class="line">4 <span class="comment"># 1st LAYER: our first layer corresponds to a shapefile layer.</span></div><div class="line">4LAYER</div><div class="line">4 	<span class="comment"># 图层名称: it is the link between the MapFile and web interfaces that refer</span></div><div class="line">4 	<span class="comment"># to this name (max=20 characters)</span></div><div class="line">4 	NAME <span class="string">"municipalities"</span></div><div class="line">4 	</div><div class="line">4 	<span class="comment"># 图层状态 (values: DEFAULT = always displayed, ON = displayed on demand or</span></div><div class="line">4 	<span class="comment"># OFF = not displayed)</span></div><div class="line">4 	STATUS default</div><div class="line">4 	</div><div class="line">4 	<span class="comment"># Path and filename of the shapefile to process (without extension).</span></div><div class="line">4 	<span class="comment"># It has to be specified relatively to the SHAPEPATH option of the Map Object.</span></div><div class="line">4 	DATA <span class="string">"municipalities"</span></div><div class="line">4 	<span class="comment"># 数据类型： point/line/polygon/raster</span></div><div class="line">4 	TYPE polygon</div><div class="line">4 	<span class="comment"># Item name in the attribute table to be used for labeling.</span></div><div class="line">4 	LABELITEM <span class="string">"NAME"</span></div><div class="line">4 	<span class="comment"># Item name in the attribute table to be used for defining different thematic</span></div><div class="line">4 	<span class="comment"># classes.</span></div><div class="line">4 	CLASSITEM <span class="string">"DISTRICT"</span> </div><div class="line">44</div><div class="line">4 	<span class="comment"># Maximum scale at which the layer is labeled (double).</span></div><div class="line">4 	LABELMAXSCALE <span class="number">100000</span></div><div class="line">4 	<span class="comment"># Templates to be used to publish a set of results (multiresult query modes)</span></div><div class="line">4 	HEADER <span class="string">"header.html"</span></div><div class="line">4 	FOOTER <span class="string">"footer.html"</span></div><div class="line">4 	TEMPLATE <span class="string">"query.html"</span></div><div class="line">4 	<span class="comment"># Metadata definition needed for attribute queries (MapServer version 5+)</span></div><div class="line">4 	METADATA</div><div class="line">4 		qstring_validation_pattern <span class="string">'.'</span></div><div class="line">4 	END</div><div class="line">4 </div><div class="line">4 	<span class="comment"># Here starts the first Class Object. It defines the thematic classes of the</span></div><div class="line">4 	<span class="comment"># layer.</span></div><div class="line">4 	<span class="comment"># Each layer must have at least one class.</span></div><div class="line">4 	<span class="comment"># If more than one class has to be defined, membership is determined using</span></div><div class="line">4 	<span class="comment"># attribute values and expressions.</span></div><div class="line">4 	<span class="comment"># It starts with the keyword CLASS and terminates with the keyword END.</span></div><div class="line">4 	CLASS</div><div class="line">4 		<span class="comment"># Name to be used in the legend for the specific class. If it has not been</span></div><div class="line">4 		<span class="comment"># defined, in the legend this class doesn't appear.</span></div><div class="line">4 		NAME <span class="string">"Como district"</span></div><div class="line">4 		<span class="comment"># Value of the attribute item defined in CLASSITEM</span></div><div class="line">4 		EXPRESSION <span class="string">"Como"</span></div><div class="line">4 		<span class="comment"># Label to be used</span></div><div class="line">4 		LABEL</div><div class="line">4 			TYPE TRUETYPE</div><div class="line">4 			FONT <span class="string">"times"</span></div><div class="line">4 			SIZE <span class="number">8</span></div><div class="line">4 			<span class="comment"># Label positioning; available values: auto, ul|uc|ur|cl|cc|cr|ll|lc|lr; in</span></div><div class="line">4 			<span class="comment"># this latter case first letter refers to </span></div><div class="line">4 			<span class="comment"># Y coordinate (u= up, c= center, l= low), the second to X coordinate(l=</span></div><div class="line">4 			<span class="comment"># left, c= center, r= right.</span></div><div class="line">4 			<span class="comment"># By selecting the value "auto" MapServer is requested to calculate a</span></div><div class="line">4 			<span class="comment"># label position that will not interfere with other labels.</span></div><div class="line">4 			POSITION auto</div><div class="line">4 			<span class="comment"># Label color</span></div><div class="line">4 			COLOR <span class="number">155</span> <span class="number">155</span> <span class="number">155</span></div><div class="line">4 		END</div><div class="line">4 		<span class="comment"># Style to be used for the feautures of the layer.</span></div><div class="line">4 		STYLE</div><div class="line">4 			<span class="comment"># Color to be used for drawing features.</span></div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">255</span></div><div class="line">4 			<span class="comment"># Color to be used for outlining polygons.</span></div><div class="line">4 			OUTLINECOLOR <span class="number">0</span> <span class="number">255</span> <span class="number">0</span></div><div class="line">4 		END</div><div class="line">4 	END</div><div class="line">4 	<span class="comment"># See previous class for comments</span></div><div class="line">44CLASS</div><div class="line">444NAME <span class="string">"Varese district"</span></div><div class="line">444EXPRESSION <span class="string">"Varese"</span></div><div class="line">444LABEL</div><div class="line">4444TYPE TRUETYPE</div><div class="line">4444FONT <span class="string">"times"</span></div><div class="line">4444SIZE <span class="number">8</span></div><div class="line">4444POSITION AUTO</div><div class="line">4444COLOR <span class="number">155</span> <span class="number">155</span> <span class="number">155</span></div><div class="line">444END</div><div class="line">444STYLE</div><div class="line">4444COLOR <span class="number">110</span> <span class="number">210</span> <span class="number">55</span></div><div class="line">4444OUTLINECOLOR <span class="number">225</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">444END </div><div class="line">44END</div><div class="line">4END</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line"></div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># 3rd LAYER: it is a raster layer (see 2nd layer)</span></div><div class="line">4LAYER</div><div class="line">44NAME <span class="string">"NEraster"</span></div><div class="line">        <span class="comment"># Name of the group that the layer belongs to.</span></div><div class="line">44<span class="comment"># The group allows to do things like turning on and off a group of layers at</span></div><div class="line">44<span class="comment"># once.</span></div><div class="line">44<span class="comment">#GROUP "raster4"</span></div><div class="line">44STATUS on</div><div class="line">        <span class="comment"># Name of the data file: a path relative to SHAPEPATH is used.</span></div><div class="line">44DATA <span class="string">"../raster/ne.tif"</span></div><div class="line">44TYPE raster </div><div class="line">        <span class="comment"># Scale at which the layer is drawn.</span></div><div class="line">44MINSCALEDENOM <span class="number">2000</span></div><div class="line">44MAXSCALEDENOM <span class="number">25000</span></div><div class="line">4END</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line"></div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># 6th LAYER: it is a vector (shp file) layer </span></div><div class="line">4 LAYER</div><div class="line">4 	NAME <span class="string">"lakes"</span></div><div class="line">4 	STATUS default</div><div class="line">4 	DATA <span class="string">"lakes"</span></div><div class="line">4 	TYPE polygon</div><div class="line">4 	LABELITEM <span class="string">"NAME"</span></div><div class="line">4 	CLASS</div><div class="line">4 		NAME <span class="string">"Lakes"</span></div><div class="line">4 		STYLE</div><div class="line">4 			<span class="comment"># Name (or number) of the symbol to be used for the features</span></div><div class="line">4 			<span class="comment"># Symbols are defined in the file given in the SYMBOLSET parameter</span></div><div class="line">4 			SYMBOL <span class="string">"lakes_ellipse"</span></div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">215</span> <span class="number">240</span></div><div class="line">4 			OUTLINECOLOR <span class="number">0</span> <span class="number">215</span> <span class="number">240</span></div><div class="line">4 		END</div><div class="line">4 		LABEL</div><div class="line">4 			TYPE truetype</div><div class="line">4 			FONT <span class="string">"mtypcors"</span></div><div class="line">4 			SIZE <span class="number">11</span></div><div class="line">4 			<span class="comment"># Label positioning; available values: auto, ul|uc|ur|cl|cc|cr|ll|lc|lr; in</span></div><div class="line">4 			<span class="comment"># this latter case first letter refers to Y coordinate (u= up, c= center,</span></div><div class="line">4 			<span class="comment"># l= low), the second to X coordinate(l= left, c= center, r= right).</span></div><div class="line">4 			<span class="comment"># By selecting the value "auto", MapServer is requested to calculate a</span></div><div class="line">4 			<span class="comment"># label position that will not interfere with other labels.</span></div><div class="line">4 			POSITION AUTO</div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">255</span></div><div class="line">4 			BACKGROUNDCOLOR <span class="number">255</span> <span class="number">255</span> <span class="number">0</span></div><div class="line">4 		END</div><div class="line">4 	END</div><div class="line">4 END</div><div class="line">4<span class="comment">#........................................................................... </span></div><div class="line">4 <span class="comment"># 7th LAYER: it is a vector (shp file) layer</span></div><div class="line">4 LAYER</div><div class="line">4 	NAME <span class="string">"railways"</span></div><div class="line">4 	STATUS on</div><div class="line">4 	DATA <span class="string">"railways"</span></div><div class="line">4 	TYPE line</div><div class="line">4 	MAXSCALEDENOM <span class="number">100000</span></div><div class="line">4 	CLASS</div><div class="line">4 		NAME <span class="string">"Railways"</span></div><div class="line">4 		STYLE</div><div class="line">4 			SYMBOL <span class="string">"point"</span></div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">4 			SIZE <span class="number">7</span></div><div class="line">4 		END</div><div class="line">4 		STYLE</div><div class="line">4 			SYMBOL <span class="string">"point"</span></div><div class="line">4 			COLOR <span class="number">255</span> <span class="number">255</span> <span class="number">0</span></div><div class="line">4 			SIZE <span class="number">5</span></div><div class="line">4 		END</div><div class="line">4 		STYLE</div><div class="line">4 			SYMBOL <span class="string">"line10-10"</span></div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div><div class="line">4 			SIZE <span class="number">1</span></div><div class="line">4 		END</div><div class="line">4 	END</div><div class="line">4 END</div><div class="line">4</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># 8th LAYER:it is a vector (shp file) layer. A different projection (UTM32/WGS84</span></div><div class="line">4 <span class="comment"># characterises the data.</span></div><div class="line">4 LAYER </div><div class="line">4 	NAME <span class="string">"stations"</span></div><div class="line">4 	STATUS on</div><div class="line">4 	DATA <span class="string">"stations"</span></div><div class="line">4 	TYPE point</div><div class="line">4 	CLASSITEM <span class="string">"COMP_CODE"</span></div><div class="line">4 	LABELITEM <span class="string">"NAME"</span></div><div class="line">4 	LABELMAXSCALEDENOM <span class="number">100000</span></div><div class="line">4 	HEADER <span class="string">"header_f.html"</span></div><div class="line">4 	FOOTER <span class="string">"footer_f.html"</span></div><div class="line">4 	TEMPLATE <span class="string">"query_f.html"</span></div><div class="line">4 	<span class="comment"># Projection: 32632 is the CRS UTM32/WGS84 code.</span></div><div class="line">4 	PROJECTION</div><div class="line">4 		<span class="string">"init=epsg:32632"</span></div><div class="line">4 	END</div><div class="line">4 	METADATA</div><div class="line">4 		qstring_validation_pattern <span class="string">'.'</span></div><div class="line">4 	END</div><div class="line">4 	CLASS</div><div class="line">4 		NAME <span class="string">"FNM stations (WGS84-UTM)"</span></div><div class="line">4 		<span class="comment"># Four different kind of EXPRESSION are available to define the membership</span></div><div class="line">4 		<span class="comment"># to one specific class:</span></div><div class="line">4 		<span class="comment"># strings comparison (case sensitive and fastest to evaluate).</span></div><div class="line">4 		<span class="comment"># regular expression (a regular expression ( regexp or regex is a string</span></div><div class="line">4 		<span class="comment"># that describes or matches a set of strings,</span></div><div class="line">4 		<span class="comment"># according to certain syntax rules. For example</span></div><div class="line">4 		<span class="comment"># they are used by text editors and utilities</span></div><div class="line">4 		<span class="comment"># to search and manipulate bodies of text based on</span></div><div class="line">4 		<span class="comment"># certain patterns).</span></div><div class="line">4 		<span class="comment"># Examples available at:</span></div><div class="line">4 		<span class="comment"># http://umn.mapserver.ch/index_en.php</span></div><div class="line">4 		<span class="comment"># logical expression, delimited by parentheses "(expression)". Attribute </span></div><div class="line">444</div><div class="line">4 		<span class="comment"># names are delimited by square brackets "[ATTRIBUTE]".</span></div><div class="line">4 		<span class="comment"># The following logical operators are supported:</span></div><div class="line">4 		<span class="comment"># =,&gt;,&lt;,&lt;=,&gt;=,=,or,and,lt,gt,ge,le,eq,ne.</span></div><div class="line">4 		<span class="comment"># lenght function of the string;</span></div><div class="line">4 		<span class="comment"># example: EXPRESSION (length('[NAME_E]') &lt; 8)</span></div><div class="line">4 		<span class="comment">#</span></div><div class="line">4 		<span class="comment"># In the following, by using expression, "FNM" and "FS" stations are</span></div><div class="line">4 		<span class="comment"># given different symbols and colors.</span></div><div class="line">4 		EXPRESSION <span class="string">"FNM"</span></div><div class="line">4 		LABEL</div><div class="line">4 			TYPE truetype</div><div class="line">4 			FONT <span class="string">"arial"</span></div><div class="line">4 			SIZE <span class="number">9</span></div><div class="line">4 			POSITION auto</div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">200</span> <span class="number">0</span></div><div class="line">4 			BACKGROUNDCOLOR <span class="number">200</span> <span class="number">255</span> <span class="number">0</span></div><div class="line">4 			<span class="comment">#SHADOWSIZE 1 1</span></div><div class="line">4 			<span class="comment">#SHADOWCOLOR 0 0 0</span></div><div class="line">4 			<span class="comment">#BACKGROUNDSHADOWSIZE 5 5</span></div><div class="line">4 			<span class="comment">#BACKGROUNDSHADOWCOLOR 0 100 0</span></div><div class="line">4 		END</div><div class="line">4 		STYLE</div><div class="line">4 			SYMBOL <span class="string">"7x7square"</span></div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">200</span> <span class="number">0</span></div><div class="line">4 		END</div><div class="line">4 	END</div><div class="line">4 	CLASS</div><div class="line">4 		NAME <span class="string">"FS stations (WGS84-UTM)"</span></div><div class="line">4 		EXPRESSION <span class="string">"FS"</span></div><div class="line">4 		LABEL</div><div class="line">4 			TYPE truetype</div><div class="line">4 			FONT <span class="string">"mtypcors"</span></div><div class="line">4 			SIZE <span class="number">10</span></div><div class="line">4 			POSITION auto </div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">157</span></div><div class="line">4 			BACKGROUNDCOLOR <span class="number">0</span> <span class="number">220</span> <span class="number">255</span></div><div class="line">4 		END</div><div class="line">4 		STYLE</div><div class="line">4 			SYMBOL <span class="string">"7x7square"</span></div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">157</span></div><div class="line">4 		END</div><div class="line">4 	END</div><div class="line">4 END</div><div class="line">4<span class="comment">#...........................................................................</span></div><div class="line">4 <span class="comment"># 9th LAYER: it is a vector (MapInfo) layer. It is read through the OGR library.</span></div><div class="line">4 LAYER</div><div class="line">4 	NAME <span class="string">"alluvional-cones"</span></div><div class="line">4 	STATUS on</div><div class="line">4 	TYPE line</div><div class="line">4 	<span class="comment"># CONNECTIONTYPE specifies the connection:</span></div><div class="line">4 	<span class="comment"># CONNECTIONTYPE [local|sde|ogr|postgis|oraclespatial|wms]</span></div><div class="line">4 	CONNECTIONTYPE OGR</div><div class="line">44</div><div class="line">4 	<span class="comment"># Relative path and data file (here the path is from the mapfile)</span></div><div class="line">4 	CONNECTION <span class="string">"data/ogr/alluvional-cones.tab"</span></div><div class="line">4 	MAXSCALEDENOM <span class="number">100000</span></div><div class="line">4 	CLASS</div><div class="line">4 		NAME <span class="string">"Alluvional cones"</span></div><div class="line">4 		STYLE</div><div class="line">4 			COLOR <span class="number">214</span> <span class="number">49</span> <span class="number">148</span></div><div class="line">4 		END</div><div class="line">4 	END</div><div class="line">4 END</div><div class="line">4<span class="comment">#........................................................................... </span></div><div class="line">4</div><div class="line">4 <span class="comment"># 10th LAYER: it is the same as the 8th layer but in the Gauss/Boaga projection.</span></div><div class="line">4 LAYER</div><div class="line">4 	NAME <span class="string">"stationsgb"</span></div><div class="line">4 	STATUS on</div><div class="line">4 	DATA <span class="string">"GaussBoaga/stations"</span></div><div class="line">4 	TYPE point</div><div class="line">4 	CLASSITEM <span class="string">"COMP_CODE"</span></div><div class="line">4 	LABELITEM <span class="string">"NAME"</span></div><div class="line">4 	LABELMAXSCALEDENOM <span class="number">100000</span></div><div class="line">4 	HEADER <span class="string">"header_f.html"</span></div><div class="line">4 	FOOTER <span class="string">"footer_f.html"</span></div><div class="line">4 	TEMPLATE <span class="string">"query_f.html"</span></div><div class="line">4 	CLASS</div><div class="line">4 		NAME <span class="string">"FNM stations (GB)"</span></div><div class="line">4 		EXPRESSION <span class="string">"FNM"</span></div><div class="line">4 		LABEL</div><div class="line">4 			TYPE truetype</div><div class="line">4 			FONT <span class="string">"arial"</span></div><div class="line">4 			SIZE <span class="number">9</span></div><div class="line">4 			POSITION auto</div><div class="line">4 			COLOR <span class="number">0</span> <span class="number">200</span> <span class="number">0</span></div><div class="line">4 			BACKGROUNDCOLOR <span class="number">200</span> <span class="number">255</span> <span class="number">0</span></div><div class="line">4 		END</div><div class="line">4 		STYLE</div><div class="line">4 			SYMBOL <span class="string">"7x7square"</span></div><div class="line">4 			COLOR <span class="number">250</span> <span class="number">215</span> <span class="number">0</span></div><div class="line">4 		END</div><div class="line">4 	END</div><div class="line">4 	CLASS</div><div class="line">4 		 NAME <span class="string">"FS stations (GB)"</span></div><div class="line">4 		 EXPRESSION <span class="string">"FS"</span></div><div class="line">4 		 LABEL </div><div class="line">444 	 TYPE truetype</div><div class="line">444 	 FONT <span class="string">"mtypcors"</span></div><div class="line">444 	 SIZE <span class="number">10</span></div><div class="line">444 	 POSITION auto</div><div class="line">444 	 COLOR <span class="number">0</span> <span class="number">0</span> <span class="number">157</span></div><div class="line">444 	 BACKGROUNDCOLOR <span class="number">0</span> <span class="number">220</span> <span class="number">255</span></div><div class="line">4 		 END</div><div class="line">444 STYLE</div><div class="line">444 	SYMBOL <span class="string">"7x7square"</span></div><div class="line">444 	COLOR <span class="number">230</span> <span class="number">70</span> <span class="number">157</span></div><div class="line">444 END</div><div class="line">4 	END</div><div class="line">4 END</div><div class="line"><span class="comment"># end of the Map Object</span></div><div class="line">END</div></pre></td></tr></table></figure></div></div><div class="copyright"><p><span>本文标题:</span><a href="/2016/12/19/MapServer之MapFile学习/">MapServer之MapFile学习</a></p><p><span>文章作者:</span><a href="/" title="回到主页">侯志伟 - houzhiwei</a></p><p><span>发布时间:</span>2016-12-19, 14:54:43</p><p><span>最后更新:</span>2018-06-12, 16:09:40</p><p><span>原始链接:</span><a class="post-url" href="/2016/12/19/MapServer之MapFile学习/" title="MapServer之MapFile学习">houzw.github.io.git/2016/12/19/MapServer之MapFile学习/</a> <span class="copy-path" data-clipboard-text="原文: houzw.github.io.git/2016/12/19/MapServer之MapFile学习/　　作者: 侯志伟 - houzhiwei" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span><script>var clipboard=new Clipboard(".copy-path")</script></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。</p></div><nav id="article-nav"><div id="article-nav-newer" class="article-nav-title"><a href="/2016/12/25/空间信息技术3S概述/">空间信息技术——3S概述</a></div><div id="article-nav-older" class="article-nav-title"><a href="/2016/12/18/WebService-学习基础-1/">WebService 学习基础-1</a></div></nav></article><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MapServer之MapFile学习"><span class="toc-number">1.</span> <span class="toc-text">MapServer之MapFile学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MapFile简介"><span class="toc-number">1.1.</span> <span class="toc-text">MapFile简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MapFile的头部"><span class="toc-number">1.2.</span> <span class="toc-text">MapFile的头部</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对象属性"><span class="toc-number">1.3.</span> <span class="toc-text">对象属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MAP对象"><span class="toc-number">1.3.1.</span> <span class="toc-text">MAP对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MAP对象的主要属性（MAP对象内部的LAYER对象等下文说明）："><span class="toc-number">1.3.1.1.</span> <span class="toc-text">MAP对象的主要属性（MAP对象内部的LAYER对象等下文说明）：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WEB对象"><span class="toc-number">1.3.2.</span> <span class="toc-text">WEB对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Projection"><span class="toc-number">1.4.</span> <span class="toc-text">Projection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LAYER对象"><span class="toc-number">1.4.1.</span> <span class="toc-text">LAYER对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Vector-layer"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">Vector layer</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Shapefile"><span class="toc-number">1.4.1.1.1.</span> <span class="toc-text">Shapefile</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Mapinfo-TAB"><span class="toc-number">1.4.1.1.2.</span> <span class="toc-text">Mapinfo TAB</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Query"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">Query</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Metadata"><span class="toc-number">1.4.2.</span> <span class="toc-text">Metadata</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WIKI"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">WIKI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Geotiff"><span class="toc-number">1.4.2.1.1.</span> <span class="toc-text">Geotiff</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Image-Tiles"><span class="toc-number">1.4.2.1.2.</span> <span class="toc-text">Image Tiles</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Grid-Layer"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">Grid Layer</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WMS图层"><span class="toc-number">1.4.3.</span> <span class="toc-text">WMS图层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DOWNLOAD"><span class="toc-number">1.4.4.</span> <span class="toc-text">DOWNLOAD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference对象（鹰眼）"><span class="toc-number">1.4.5.</span> <span class="toc-text">Reference对象（鹰眼）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Legend"><span class="toc-number">1.4.6.</span> <span class="toc-text">Legend</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Scalebar"><span class="toc-number">1.4.7.</span> <span class="toc-text">Scalebar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QUERYMAP"><span class="toc-number">1.4.8.</span> <span class="toc-text">QUERYMAP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OUTPUTFORMAT"><span class="toc-number">1.5.</span> <span class="toc-text">OUTPUTFORMAT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#带注释示例"><span class="toc-number">1.6.</span> <span class="toc-text">带注释示例</span></a></li></ol></li></ol></div><style>.left-col .switch-area,.left-col .switch-btn{display:none}.toc-level-3 i,.toc-level-3 ol{display:none!important}</style><input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录"><script>yiliaConfig.toc=["隐藏目录","显示目录",!0]</script><div class="share"><div class="bdsharebuttonbox"><a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a> <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a> <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a> <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a> <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a> <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a> <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></a></div><script>with(window._bd_share_config={common:{bdSnsKey:{},bdText:"MapServer之MapFile学习　| V make the world smart　",bdMini:"2",bdMiniList:!1,bdPic:"",bdStyle:"0",bdSize:"24"},share:{}},document)(0)[(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)]</script></div><section class="youyan" id="comments"><script>var loadComment=function(){var e=document,a=e.createElement("script");a.src="http://v2.uyan.cc/code/uyan.js?uid=2117097",(e.head||e.body).appendChild(a)}</script><script>loadComment()</script><div id="uyan_frame"></div></section><div class="scroll" id="post-nav-button"><a href="/2016/12/25/空间信息技术3S概述/" title="上一篇: 空间信息技术——3S概述"><i class="fa fa-angle-left"></i> </a><a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a> <a href="/2016/12/18/WebService-学习基础-1/" title="下一篇: WebService 学习基础-1"><i class="fa fa-angle-right"></i></a></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/06/11/MapServer学习之-WMS/">MapServer学习之 WMS</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/25/CentOS-MySql-安装/">CentOS MySql 安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/开源地理信息软件或算法库/">开源地理信息软件或算法库</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/Data Portal Collection/">Data Portal Collection</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/10/GIS RS  学术期刊/">GIS / RS 主要学术期刊</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/24/Spring MVC 接受的请求参数/">Spring MVC 接受的请求参数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/24/Mybatis分页插件PageHelper使用/">Mybatis分页插件PageHelper使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/21/52°North-WPS-学习-发布处理服务-01/">52°North-WPS-学习-发布处理服务-01</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/20/52°North-WPS-学习-客户端API教程/">52°North-WPS-学习-客户端API教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/27/GeoTools-读取-Geotiff-文件/">GeoTools 读取 Geotiff 文件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/30/BAT-批处理程序学习/">BAT 批处理程序学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/10/使用Jena执行SPARQL的Select和Ask查询/">使用Jena执行SPARQL的Select和Ask查询</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/08/知识图谱-资源收集/">知识图谱-资源收集</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/19/GRASS-GIS 下 TOPMODEL 运行/">GRASS GIS 下 TOPMODEL 运行</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/11/52°North-WPS-学习/">52°North WPS 学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/08/Linux-目录结构/">Linux 目录结构</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/07/Apache-CXF-Web-Service-Development笔记-01/">Apache CXF Web Service Development笔记 01</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/31/Vuex-学习/">Vuex 学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/30/TauDEM-计算TWI/">TauDEM 计算 TWI</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/30/Mybatis模糊查询/">Ibatis/Mybatis模糊查询</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/vue-cli webpack/">vue-cli webpack</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/22/ES6-新特性学习/">ES6 新特性学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/公共CDN整理/">公共CDN整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/Openlayers3-01/">Openlayers3-01</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/OpenLayers-3-扩展插件/">OpenLayers 3 扩展插件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/12/科研相关软件工具整理/">科研相关软件工具整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/02/GRASS-GIS-手册-命令行启动程序说明/">GRASS GIS 手册 -命令行启动程序说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/18/Webpack-从入门到放弃-插件/">Webpack-从入门到放弃 - 插件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/17/GRASS-GIS-手册：快速入门/">GRASS GIS 手册：快速入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/Webpack-从入门到放弃-多页面/">Webpack - 从入门到放弃 - 多页面</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/15/Webpack-从入门到放弃/">Webpack：从入门到放弃</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/18/MapServer之安装和基本使用/">MapServer之安装和基本使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/Crypto-js--Quick-start-Guide/">Crypto-js - Quick-start Guide</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/25/空间信息技术3S概述/">空间信息技术——3S概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/19/MapServer之MapFile学习/">MapServer之MapFile学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/WebService-学习基础-1/">WebService 学习基础-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/13/SOAP教程/">SOAP教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/10/GDAL-Python-学习笔记-1/">GDAL Python 学习笔记-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/10/TauDEM-命令行使用方法/">TauDEM 命令行使用方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/06/Windows-下使用VNC连接-CentOS7-桌面/">Windows 下使用VNC连接 CentOS7 桌面</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/04/地理空间及空间关系/">地理空间及空间关系</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/GIS基本概念/">GIS基本概念</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/26/Linux基础/">Linux 学习之2</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/Windows下SSH安装使用/">Windows下SSH安装使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/24/WebService-学习基础/">WebService 学习基础-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/Apache-CXF-配置/">Apache CXF 配置【TBD】</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/Apache-CXF-利用spring写一个服务/">Apache-CXF-利用spring写一个服务</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/18/CentOS 7 基本使用/">CentOS 7 基本使用(TBD)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/16/本体编辑器（Ontology Editor）介绍/">本体编辑器（Ontology Editor）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/14/Header First 设计模式-01-设计模式入门/">Header First 设计模式-01-设计模式入门（To Be Done）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/05/软件开发规范/">软件开发规范</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/04/Apache Shiro学习 - 5 - Realms/">Apache Shiro学习 - 5 - Realms</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/03/地形因子分类整合/">地形因子分类整合方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/WSDL 教程/">WSDL 教程 [To be continued]</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/Apache CXF 使用 - 04 -简介 -  如何开发一个服务的客户端/">Apache CXF 使用 - 04 -简介 - 如何开发一个服务的客户端</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/Apache CXF 使用 - 03 -简介 -  如何开发一个服务/">Apache CXF 使用 - 03 -简介 - 如何开发一个服务</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/Apache CXF Web Service开发 - 01/">Apache CXF Web Service开发笔记 - 01</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/Apache CXF 使用 - 02 - Maven/">Apache CXF 使用教程 - 02 - Maven</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/Apache CXF  使用 - 01/">Apache CXF 使用教程 - 01 - 简介 - CXF与应用程序的整合</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/25/GDAL Python 学习笔记 - 0 - 安装/">GDAL Python 学习笔记 - 0 - 安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/20/基于DEM的河网提取流程-1/">基于DEM的水系/河网提取方法、流程学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/18/TauDEM使用-ArcGIS工具箱/">TauDEM使用-ArcGIS工具箱-01</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/18/Openlayers-3-01/">OpenLayers3 学习-0-简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/18/WPS/">网络地理信息处理服务 Web Processing Service (WPS)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/10/开源地理空间基金会 OSGeo及相关项目介绍/">开源地理空间基金会 OSGeo简介</a></li></ul><script></script></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left"><i class="fa fa-copyright"></i> 2016-2018 侯志伟 - houzhiwei</div><div class="footer-right"><a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a> Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i></div></div><div class="visit"><span id="busuanzi_container_site_pv" style="display:none"><span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span> </span></span><span>| </span><span id="busuanzi_container_page_pv" style="display:none"><span id="page-visit" title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span></span></span></div></div></footer></div><script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script><script>$(document).ready(function(){var a=window.navigator.userAgent.indexOf("iPad");if(a>-1||"none"===$(".left-col").css("display")){var c=["#9db3f4","#414141","#e5a859","#f5dfc6","#c084a0","#847e72","#cd8390","#996731"],e=Math.ceil(Math.random()*(c.length-1));$("body").css({"background-color":c[e],"background-size":"cover"})}else{var d=7,o="url(/background/bg-x.jpg)".replace(/x/gi,Math.ceil(Math.random()*d));$("body").css({background:o,"background-attachment":"fixed","background-size":"cover"})}})</script><div class="scroll" id="scroll"><a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a> <a href="#comments" onclick="load$hide()" title="查看评论"><i class="fa fa-comments-o"></i></a> <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a></div><script>var oOpenInNew={archives:".archive-article-title",miniArchives:"a.post-list-link",friends:"#js-friends a",socail:".social a"};for(var x in oOpenInNew)$(oOpenInNew[x]).attr("target","_blank")</script><script>var originTitle=document.title,titleTime;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="(つェ⊂) 我藏好了哦~ "+originTitle,clearTimeout(titleTime)):(document.title="(*´∇｀*) 被你发现啦~ "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))})</script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body><!-- rebuild by neat -->